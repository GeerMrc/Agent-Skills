# Frontend Design Agent Skills - 开发流程规范

> 📖 **版本**: v1.1
> 📅 **更新日期**: 2025-01-04
> 👤 **维护者**: 项目团队

---

## 📑 目录

- [开发流程概述](#开发流程概述)
- [阶段开发规范](#阶段开发规范) ⭐ 新增
- [9阶段开发流程](#9阶段开发流程)
- [Git工作流规范](#git工作流规范)
- [代码质量检查](#代码质量检查)
- [提交前验证](#提交前验证)
- [代码审查标准](#代码审查标准)

---

## 🔄 开发流程概述

本项目采用标准化的9阶段开发流程，确保代码质量和项目可维护性。

### 流程图

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  需求分析   │───▶│  方案设计   │───▶│  任务拆解   │
└─────────────┘    └─────────────┘    └─────────────┘
                                             │
                                             ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  Git 提交   │◀───│  代码审查   │◀───│  测试验证   │
└─────────────┘    └─────────────┘    └─────────────┘
                                             ▲
                                             │
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  文档更新   │◀───│  部署发布   │◀───│  代码实现   │
└─────────────┘    └─────────────┘    └─────────────┘
```

---

## ⚠️ 阶段开发规范

> **重要**: 本规范是避免技术债务和确保项目质量的核心控制机制

### 📋 每阶段开发前必须执行的规范

**每推进下一个阶段的开发任务前，必须：**

1. **明确申明开发流程**
   - 明确引用 `docs/DEVELOPMENT_WORKFLOW.md` 作为唯一开发流程规范
   - 确认当前阶段已完成并通过所有验证

2. **制定TODO开发清单**
   - 基于 `TASK.md` 任务追踪文档
   - 为每个阶段任务创建详细的TODO清单
   - 使用TodoWrite工具实时跟踪任务状态

3. **执行交叉验证确认**
   - 每个TODO完成后必须进行交叉验证
   - 验证内容包括：代码质量、文档同步、git状态
   - 确认无遗漏后再标记为完成

### 🔄 TASK.md同步提交规范

**TASK.md是项目的唯一任务追踪文档，必须保持与实际开发同步：**

1. **每阶段完成后必须更新TASK.md**
   - 更新任务状态（TODO → IN_PROGRESS → DONE）
   - 记录完成时间和备注信息
   - 更新项目进度百分比和进度条

2. **TASK.md更新必须立即git commit**
   - 每个阶段完成后，TASK.md的更新必须作为独立提交
   - 提交信息遵循Conventional Commits规范
   - 提交前必须进行交叉验证确认

3. **禁止批量延迟提交**
   - 严禁多个阶段的TASK.md更新合并为一次提交
   - 每个阶段的文档更新必须独立可追溯
   - 避免造成进度记录混乱

### 🔍 交叉验证确认清单

**每完成一个阶段任务，必须执行以下验证：**

```bash
# 1. 确认git状态
git status                    # 确认工作区状态

# 2. 确认提交历史
git log --oneline -5          # 确认提交顺序正确

# 3. 确认TASK.md更新
grep "Phase X" TASK.md        # 确认阶段状态已更新

# 4. 确认CHANGELOG.md更新
grep "vX.X.X" CHANGELOG.md    # 确认版本信息已记录
```

### ⚠️ 违反规范的后果

| 违反行为 | 后果 | 严重程度 |
|----------|------|----------|
| 未更新TASK.md就进入下一阶段 | 进度追踪混乱，任务遗漏 | 🔴 严重 |
| 未git commit就进入下一阶段 | 代码丢失，无法回溯 | 🔴 严重 |
| 未进行交叉验证 | 技术债务累积 | 🟠 重要 |
| 批量提交多个阶段 | 历史记录不清，难以追溯 | 🟡 警告 |

### 📝 规范执行示例

```markdown
## 正确的阶段开发流程

### 阶段开始
> 明确申明: "遵循 `docs/DEVELOPMENT_WORKFLOW.md` 规范，开始Phase X开发"

### 创建TODO清单
- [ ] TASK-101: 具体任务1
- [ ] TASK-102: 具体任务2
- [ ] TASK-103: 具体任务3

### 执行并验证
- 完成TASK-101 → 交叉验证 → 标记完成
- 完成TASK-102 → 交叉验证 → 标记完成
- 完成TASK-103 → 交叉验证 → 标记完成

### 阶段完成
- 更新TASK.md → git commit → 交叉验证 → 进入下一阶段
```

---

## 📋 9阶段开发流程

### 阶段1：需求分析

**目标**：明确功能需求和技术约束

**关键活动**：
- 收集并分析用户需求
- 识别技术约束和依赖
- 确定功能优先级
- 定义验收标准

**输出**：
- 需求文档
- 技术约束清单
- 验收标准

### 阶段2：方案设计

**目标**：设计系统架构和技术方案

**关键活动**：
- 设计系统架构
- 选择技术栈
- 设计数据模型
- 制定接口规范

**输出**：
- 架构设计文档
- 技术选型说明
- 数据模型设计

### 阶段3：任务拆解

**目标**：创建TASK.md任务清单

**关键活动**：
- 拆解功能模块
- 估算工作量
- 排定优先级
- 分配任务

**输出**：
- 更新的TASK.md
- 任务分配表

### 阶段4：代码实现

**目标**：实现功能代码

**关键活动**：
- 编写代码
- 编写单元测试
- 代码自审
- 更新TASK.md

**输出**：
- 功能代码
- 单元测试
- 更新的TASK.md

### 阶段5：测试验证

**目标**：确保代码质量

**关键活动**：
- 运行单元测试
- 集成测试
- 性能测试
- 无障碍测试

**输出**：
- 测试报告
- 性能基准

### 阶段6：代码审查

**目标**：同行评审

**关键活动**：
- 功能性审查
- 代码质量审查
- 性能审查
- 安全审查

**输出**：
- 审查反馈
- 修改建议

### 阶段7：Git提交

**目标**：版本控制

**关键活动**：
- 遵循Conventional Commits
- 通过Pre-commit Hook检查
- 关联Issue
- 创建版本标签

**输出**：
- Git提交记录
- 版本标签

### 阶段8：文档更新

**目标**：同步文档

**关键活动**：
- 更新TASK.md
- 更新CHANGELOG.md
- 更新API文档
- 更新使用示例

**输出**：
- 更新的文档
- API文档

### 阶段9：部署发布

**目标**：发布版本

**关键活动**：
- 创建Git标签
- 生成发布说明
- 部署到生产环境
- 通知stakeholders

**输出**：
- 发布说明
- 部署确认

---

## 🌳 Git工作流规范

### 分支策略（Git Flow）

```
main (生产环境)
  ├── develop (开发集成)
  │     ├── feature/* (功能分支)
  │     ├── fix/* (修复分支)
  │     └── hotfix/* (紧急修复)
  └── release/* (发布准备)
```

### 分支命名规范

| 类型 | 格式 | 示例 |
|------|------|------|
| 功能分支 | `feature/<name>` | `feature/design-token-system` |
| 修复分支 | `fix/<issue>-<desc>` | `fix-123-token-validation` |
| 紧急修复 | `hotfix/<version>-<desc>` | `hotfix-2.0.1-critical-bug` |
| 发布分支 | `release/<version>` | `release/2.0.0` |

### 提交规范（Conventional Commits）

```
type(scope): subject

body

footer
```

**类型（type）**：
- `feat`: 新功能
- `fix`: 问题修复
- `docs`: 文档更新
- `style`: 代码格式
- `refactor`: 代码重构
- `test`: 测试相关
- `chore`: 构建工具

**示例**：
```
feat(design-tokens): add OKLCH color system support

Implement OKLCH color space for better perceptual uniformity.
Includes token definitions and conversion utilities.

Closes #123
```

---

## ✅ 代码质量检查

### 质量标准

- 代码覆盖率 > 80%
- 所有公共方法必须有测试用例
- 边界条件和异常情况必须覆盖

### 自动化检查

- Pre-commit Hook自动化
- CI/CD流水线检查
- 静态代码分析

### 手动检查

- 代码可读性
- 设计模式合理性
- 性能考虑
- 安全最佳实践

---

## 🔍 提交前验证

### 检查清单

- [ ] TASK.md中的任务已标记为完成
- [ ] 所有测试通过
- [ ] 代码符合风格规范
- [ ] 文档已同步更新
- [ ] CHANGELOG.md已更新
- [ ] Commit message符合规范
- [ ] 无敏感信息泄露
- [ ] 向后兼容性已验证

### 安全检查

- 无硬编码密钥或敏感信息
- 输入验证和清理
- 遵循最小权限原则
- 依赖包安全漏洞检查

---

## 👥 代码审查标准

### 审查清单

**功能性**：
- [ ] 功能实现正确
- [ ] 边界条件处理
- [ ] 错误处理完善

**代码质量**：
- [ ] 代码可读性
- [ ] 命名规范
- [ ] 注释完整

**性能**：
- [ ] 无明显性能问题
- [ ] 资源使用合理
- [ ] 无内存泄漏

**安全性**：
- [ ] 无安全漏洞
- [ ] 输入验证
- [ ] 权限控制

**可维护性**：
- [ ] 代码结构清晰
- [ ] 易于扩展
- [ ] 文档完整

---

## 🎯 技能包发布规范

> **重要**: 发布技能包前必须遵循的规范

### ⚠️ GitHub 仓库 vs 发布的技能包

必须明确区分两个概念：

| 概念 | 内容 | 用途 |
|------|------|------|
| **GitHub 仓库** | 所有文件 + docs/ + 开发文档 | 开发管理、版本控制 |
| **发布的技能包** | 只包含技能运行所需文件 | AI Agent 使用 |

### 📦 技能包发布流程

```
1. 正确的技能包发布功能
   ├── 确定技能包根目录
   ├── 排除 docs/ 目录
   ├── 排除开发过程文件
   └── 只包含技能运行所需文件

2. 正确的指定测试解压目录
   ├── 创建临时测试目录
   ├── 解压发布包到测试目录
   └── 准备验证环境

3. 正确的检验确认符合规范
   ├── 验证 SKILL.md 存在
   ├── 验证必需文件存在
   ├── 验证目录结构符合规范
   ├── 验证不包含 docs/ 目录
   └── 验证不包含开发文档

4. 如果符合规范要求
   ├── 清理解压测试目录
   ├── 清理临时文件
   └── 验证通过

5. 如果不符合规范要求
   ├── 执行交叉验证确认
   ├── 修正/修复问题
   └── 重新执行发布流程
```

### ❌ 发布包排除规则

发布技能包时，**必须排除**以下内容：

| 排除项 | 原因 |
|--------|------|
| `docs/` | 开发文档，不是技能运行所需 |
| `TASK.md` | 任务追踪文档 |
| `FRONTEND-DESIGN-DEVELOPMENT-PLAN.md` | 开发计划 |
| `PRE_RELEASE_AUDIT_REPORT.md` | 审计报告 |
| `QUALITY_VALIDATION_REPORT.md` | 验证报告 |
| `RELEASE_NOTES.md` | 发布说明 |
| `MIGRATION_GUIDE.md` | 迁移指南 |
| `ARCHITECTURE.md` | 架构文档 |
| `API.md` | API 文档 |
| `DEVELOPMENT_WORKFLOW.md` | 开发流程规范 |
| `AGENT_SKILLS_RELEASE_SPEC.md` | 发布规范文档 |
| `.git/` | Git 版本控制 |

### ✅ 发布包包含规则

发布技能包时，**只包含**以下内容：

| 包含项 | 说明 |
|--------|------|
| `SKILL.md` | ✅ 必需 - 技能入口文件 |
| `LICENSE` | ✅ 可选 - 许可证 |
| `README.md` | ✅ 可选 - 技能说明 |
| `CHANGELOG.md` | ✅ 可选 - 变更日志 |
| `CONTRIBUTING.md` | ✅ 可选 - 贡献指南 |
| `scripts/` | ✅ 可选 - 技能运行所需脚本 |
| `references/` | ✅ 可选 - 技能参考文档 |
| `templates/` | ✅ 可选 - 项目模板 |
| `tests/` | ✅ 可选 - 测试文件 |
| `assets/` | ✅ 可选 - 静态资源 |

### 📋 发布前验证清单

发布技能包前，必须执行以下验证：

```bash
# 1. 验证 SKILL.md 存在
ls SKILL.md

# 2. 验证必需的 MD 文件存在
ls README.md CHANGELOG.md

# 3. 验证不包含 docs/ 目录
! test -d docs/

# 4. 验证不包含开发文档
! test -f TASK.md
! test -f FRONTEND-DESIGN-DEVELOPMENT-PLAN.md
! test -f PRE_RELEASE_AUDIT_REPORT.md

# 5. 创建测试发布包
tar --exclude='.git' --exclude='docs/' --exclude='*.log' \
    -czf test-package.tar.gz .

# 6. 解压到临时目录验证
mkdir -p test-verify
tar -xzf test-package.tar.gz -C test-verify/

# 7. 验证解压后的结构
ls test-verify/
# 应该看到: SKILL.md, LICENSE, README.md, scripts/, references/, etc.
# 不应该看到: docs/, TASK.md, 等

# 8. 清理测试环境
rm -rf test-verify test-package.tar.gz
```

---

## 📖 参考资料

- [Conventional Commits](https://www.conventionalcommits.org/)
- [Git Flow](https://nvie.com/posts/a-successful-git-branching-model/)
- [开发计划](../FRONTEND-DESIGN-DEVELOPMENT-PLAN.md)

---

> **最后更新**: 2025-01-04
> **维护者**: 项目团队

---

## 📝 更新日志

### v1.1 (2025-01-04)
- 🆕 新增"阶段开发规范"章节
- 🆕 新增TASK.md同步提交规范
- 🆕 新增交叉验证确认清单
- 🆕 新增违反规范的后果说明
- 🔧 强化开发流程控制机制

### v1.0 (2025-01-03)
- 🎉 初始版本
- ✅ 9阶段开发流程
- ✅ Git工作流规范
- ✅ 代码质量检查标准
